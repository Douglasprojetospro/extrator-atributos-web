{% extends "base.html" %}

{% block title %}Página Inicial - Extrator de Atributos{% endblock %}

{% block css_adicional %}
<style>
    .hero-section {
        background-color: #3498db;
        color: white;
        padding: 4rem 0;
        margin-bottom: 2rem;
        border-radius: 8px;
    }
    
    .features {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        margin-top: 30px;
    }
    
    .feature-card {
        flex: 1;
        min-width: 250px;
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    .upload-area {
        border: 2px dashed #3498db;
        padding: 2rem;
        text-align: center;
        border-radius: 8px;
        margin-top: 2rem;
        background: #f8f9fa;
        cursor: pointer;
        transition: all 0.3s;
    }
    
    .upload-area:hover {
        background: #e9f5ff;
        border-color: #2980b9;
    }
    
    #file-name {
        margin-top: 10px;
        font-style: italic;
    }
</style>
{% endblock %}

{% block titulo_conteudo %}Bem-vindo ao Sistema de Extração de Atributos{% endblock %}

{% block conteudo_principal %}
<div class="hero-section text-center">
    <h2>Extraia informações automaticamente de descrições de produtos</h2>
    <p class="lead">Carregue sua planilha e configure os atributos que deseja extrair</p>
</div>

<div class="features">
    <div class="feature-card">
        <h3><i class="bi bi-upload"></i> Carregue sua planilha</h3>
        <p>Envie um arquivo Excel contendo as descrições dos produtos que deseja processar.</p>
    </div>
    <div class="feature-card">
        <h3><i class="bi bi-gear"></i> Configure os atributos</h3>
        <p>Defina quais informações devem ser extraídas e como devem ser formatadas.</p>
    </div>
    <div class="feature-card">
        <h3><i class="bi bi-download"></i> Exporte os resultados</h3>
        <p>Obtenha uma nova planilha com todas as informações extraídas automaticamente.</p>
    </div>
</div>

<div class="card mt-4">
    <h3>Comece agora</h3>
    
    <form method="post" enctype="multipart/form-data" action="{{ url_for('upload_arquivo') }}" id="upload-form">
        <div class="form-group">
            <label for="arquivo" class="upload-area" id="upload-label">
                <h4><i class="bi bi-cloud-arrow-up"></i> Clique para selecionar um arquivo</h4>
                <p>Arquivos suportados: .xlsx, .xls</p>
                <span id="file-name">Nenhum arquivo selecionado</span>
            </label>
            <input type="file" class="d-none" id="arquivo" name="arquivo" accept=".xlsx,.xls" required>
        </div>
        
        <div class="mt-3 text-center">
            <button type="submit" class="btn btn-primary btn-lg" id="submit-btn" disabled>
                <i class="bi bi-play-circle"></i> Processar Arquivo
            </button>
            
            <a href="{{ url_for('gerar_modelo') }}" class="btn btn-outline-secondary btn-lg ms-2">
                <i class="bi bi-download"></i> Baixar Modelo
            </a>
        </div>
    </form>
</div>

<div class="card mt-4">
    <h3>Como usar</h3>
    <ol>
        <li>Baixe o modelo de planilha ou use sua própria (com colunas "ID" e "Descrição")</li>
        <li>Carregue o arquivo usando o botão acima</li>
        <li>Configure os atributos que deseja extrair na próxima página</li>
        <li>Processe os dados e visualize os resultados</li>
        <li>Exporte a planilha com os dados extraídos</li>
    </ol>
</div>
{% endblock %}

{% block scripts_adicional %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const fileInput = document.getElementById('arquivo');
        const fileName = document.getElementById('file-name');
        const uploadLabel = document.getElementById('upload-label');
        const submitBtn = document.getElementById('submit-btn');
        
        // Mostrar nome do arquivo selecionado
        fileInput.addEventListener('change', function() {
            if (this.files && this.files[0]) {
                fileName.textContent = this.files[0].name;
                submitBtn.disabled = false;
                
                // Adicionar classe de arquivo selecionado
                uploadLabel.classList.add('file-selected');
            } else {
                fileName.textContent = 'Nenhum arquivo selecionado';
                submitBtn.disabled = true;
                uploadLabel.classList.remove('file-selected');
            }
        });
        
        // Permitir arrastar e soltar arquivos
        uploadLabel.addEventListener('dragover', function(e) {
            e.preventDefault();
            this.classList.add('dragover');
        });
        
        uploadLabel.addEventListener('dragleave', function() {
            this.classList.remove('dragover');
        });
        
        uploadLabel.addEventListener('drop', function(e) {
            e.preventDefault();
            this.classList.remove('dragover');
            
            if (e.dataTransfer.files.length) {
                fileInput.files = e.dataTransfer.files;
                const event = new Event('change');
                fileInput.dispatchEvent(event);
            }
        });
    });
</script>
{% endblock %}
